language: node_js
sudo: required
env:
  global:
  - BASE_URL=$(if [ "$TRAVIS_BRANCH" == "master" ]; then echo "gen3.org"; else echo
    "alpha.gen3.org"; fi)
  - AWS_BUCKET=$BASE_URL
before_script:
- wget https://github.com/gohugoio/hugo/releases/download/v0.100.2/hugo_extended_0.100.2_Linux-64bit.deb
- sudo dpkg -i hugo*.deb
- sudo apt-get -y install asciidoctor
- echo $AWS_BUCKET
script:
- sed -i "s|{BASE_URL}|${BASE_URL}|g" config.yaml
- hugo
deploy:
  provider: s3
  access_key_id: AKIAZRNPHKJIKXZU4Q5C
  secret_access_key:
    secure: fiQ9L7/Wuu6IiNRXfDfmfmHnKK/C3jiCelfzxEb+X+L62JxLDpQnQDnCPm0w6AHsq0EPD+QI7YeliH5isJP9ScMbeUlbHda/U8BfNcjHyrOF2vfrRO14DtDjmep5eUAI97iq1qMkRTyko1ksXLckyMQCFj5xGQrfPqExpQO/ndklxUC6WKurrzwopSKnAsiHJuZprKo9yeV76ylcujYS6dgsCoYWKtsu5I8BQXSRRCulp8GeEknyb0q3XgrKl5ETqiGe9iE11Vyk8pBa2uOAVfzsWGpcAns7S7+wdNXShCDuNPGj96CJiKZAJUeyEeg26hVRtv/mI/yAbFB4PXf4Uk+2/JuO2dgHdud5vbHM092K0wXdEPoeTKpzVrWxkScQczGhLywL9hsOOCt0XmGudApRvCDTZkyCMy5kaCZCwsr5aPzWvFJvTeTejjHXQ5F+86ZIkLVpGJn3jS6J1elqHApt8z6s2zLi9Rq19wDUjKuzke43q2pOFg76rNMMJw5GgMf4gI2qX1b4KHU2bB2595XbmB2b4kSRKCJtdq9pgZQzdEJLEpJ2Sz1tV3uohxl1hzZRkFjcYfSL7PR5fjA2yLtL76x3qrGlBKhVw08ZDKR3V5lr16qVlb9G7SepeNeedo5z6abkYRFqs3ev7dVZY0SjrU9VlUpPA/pgkSQkMT4=
  bucket: "$AWS_BUCKET"
  local_dir: public
  skip_cleanup: true
  acl: public_read
  on:
    repo: uc-cdis/gen3.org
    all_branches: true
